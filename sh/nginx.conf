server {
    listen 80;
    server_name localhost;

    if ($http_user_agent ~* "(smartphone|mobile|nokia|iphone|ipad|android|samsung|htc|blackberry)") {
        set $ua_type "@mobile";
    }

    location / {
        # set $token "";
        # if ($is_args) {
        #     set $token "&";
        # }
        # if ($http_user_agent ~* "(qihoobot|Baiduspider|Googlebot|Googlebot-Mobile|Googlebot-Image|Mediapartners-Google|Adsbot-Google|Feedfetcher-Google|Yahoo! Slurp|Yahoo! Slurp China|YoudaoBot|Sosospider|Sogou spider|Sogou web spider|MSNBot|ia_archiver|Tomato Bot|FeedDemon|JikeSpider|Indy Library|Alexa Toolbar|AskTbFXTV|AhrefsBot|CrawlDaddy|CoolpadWebkit|Java|Feedly|UniversalFeedParser|ApacheBench|Microsoft URL Control|Swiftbot|ZmEu|oBot|jaunty|Python-urllib|lightDeckReports Bot|YYSpider|DigExt|YisouSpider|HttpClient|MJ12bot|heritrix|EasouSpider|Ezooms|Pinterestbot|bingbot|FullStoryBot|facebookexternalhit|DotBot|SemrushBot|PetalBot|Storebot|BingPreview|Chrome-Lighthouse|bot)") {
        #     set $args "${args}${token}isCrawler=1";
        # }
        
        proxy_pass http://127.0.0.1:3000;
        proxy_redirect http:// https://;
        rewrite ^/account/* http://276qa.com permanent;

        rewrite ^/buy$ https://276qa.com/buy-phone permanent;
        rewrite ^/buy-phone/ https://276qa.com/buy-phone permanent;
        rewrite ^/buy/iphone https://276qa.com/buy-used-refurbished-apple? permanent;
        rewrite ^/buy/ipad https://276qa.com/buy-used-refurbished-apple? permanent;
        rewrite ^/buy/galaxy https://276qa.com/buy-used-refurbished-samsung? permanent;
        rewrite ^/buy/google https://276qa.com/buy-used-refurbished-google? permanent;
        rewrite ^/buy/oneplus https://276qa.com/buy-used-refurbished-oneplus? permanent;
        rewrite ^/buy/lg https://276qa.com/buy-used-refurbished-lg? permanent;
        rewrite ^/buy/essential https://276qa.com/buy-used-refurbished-essential? permanent;
        rewrite ^/buy-iphone https://276qa.com/buy-used-refurbished-apple? permanent;
        rewrite ^/buy-ipad https://276qa.com/buy-used-refurbished-apple? permanent;
        rewrite ^/buy-galaxy https://276qa.com/buy-used-refurbished-samsung? permanent;
        rewrite ^/buy-google https://276qa.com/buy-used-refurbished-google? permanent;
        rewrite ^/buy-oneplus https://276qa.com/buy-used-refurbished-oneplus? permanent;
        rewrite ^/buy-lg https://276qa.com/buy-used-refurbished-lg? permanent;
        rewrite ^/buy-essential https://276qa.com/buy-used-refurbished-essential? permanent;


        rewrite ^/buy-used-refurbished-ipad https://276qa.com/buy-used-refurbished-apple?;

        rewrite ^/sell-phone/apple  https://276qa.com/trade-in-apple? permanent;
        rewrite ^/sell-phone/samsung  https://276qa.com/trade-in-samsung? permanent;
        rewrite ^/sell-phone/google  https://276qa.com/trade-in-google? permanent;
        rewrite ^/sell-phone/oneplus  https://276qa.com/trade-in-oneplus? permanent;
        rewrite ^/sell-phone/lg  https://276qa.com/trade-in-lg? permanent;
        rewrite ^/sell-phone/essential  https://276qa.com/trade-in-essential? permanent;

        rewrite ^/buy/(\S+)/beta$ https://276qa.com/buy-used-refurbished-$1 permanent;
        rewrite ^/buy/(\S+)/(.*)$ https://276qa.com/buy-used-refurbished-$1 permanent;
        rewrite ^/buy/(.*)$ https://276qa.com/buy-used-refurbished-$1 permanent;

        rewrite ^/sell-phone/phone/offer https://276qa.com/trade-in-phone permanent;
        rewrite ^/sell-phone/(.*)/(\S+)/(.*)$ https://276qa.com/trade-in-$2 permanent;
        rewrite ^/sell-phone/(.*)/(\S+)$ https://276qa.com/trade-in-$2 permanent;
        rewrite ^/sell-phone/(.*)$ https://276qa.com/trade-in-$1 permanent;

        rewrite ^/sell-checkout/info$ https://276qa.com/trade-in-phone permanent;
        rewrite ^/sell-checkout/prepare-ship$ https://276qa.com/trade-in-phone permanent;
        rewrite ^/sell-checkout/shipping-payment$ https://276qa.com/trade-in-phone permanent;

        rewrite ^/buy/(.*)$ https://276qa.com/buy-used-refurbished-$1 permanent;
        rewrite ^/check-order https://276qa.com/buy-phone permanent;
        rewrite ^/buy-checkorder/checkorder/order$ https://276qa.com/buy-phone permanent;
        rewrite ^/buy-checkout https://276qa.com/buy-phone permanent;
        rewrite ^/facebook/home https://276qa.com permanent;
        rewrite ^/protection/payment https://276qa.com permanent;
        rewrite ^/sell-checkout/* https://276qa.com;
        rewrite ^/tag/* https://276qa.com/blog permanent;
        rewrite ^/tiktok/home https://276qa.com permanent;
        rewrite ^/TikTok/home https://276qa.com permanent;
        rewrite ^/twitter/home https://276qa.com permanent;
        rewrite ^/uptrade/protect https://276qa.com permanent;
        rewrite ^/buy-in-bulk$ https://276qa.com/buy-phone permanent;
        rewrite ^/buy-t-landing https://276qa.com permanent;
        rewrite ^/cart https://276qa.com permanent;
        rewrite ^/how-to-sell-my-phone https://276qa.com permanent;
        rewrite ^/limitation https://276qa.com permanent;
        rewrite ^/more https://276qa.com permanent;
        rewrite ^/return-policy https://276qa.com permanent;
        rewrite ^/sell$ https://276qa.com permanent;
        rewrite ^/sell-phone$ https://276qa.com/trade-in-phone permanent;
        rewrite ^/sell-in-bulk https://276qa.com permanent;
        rewrite ^/seller-listing-policy https://276qa.com permanent;
        rewrite ^/student-discount https://276qa.com permanent;
        rewrite ^/tiktok https://276qa.com permanent;

    }

    location = / {
        proxy_pass http://127.0.0.1:3000;
    }

}
